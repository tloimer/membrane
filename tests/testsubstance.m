function testsubstance(name)
%TESTSUBSTANCE Compare correlations with data from nist.
%  TESTSUBSTANCE(NAME) creates a number of figures which show the difference in
%  the values of properties for the substance NAME as returned by the
%  correlation functions and as retrieved on 30 Sep. 2014 and 20 Okt. 2014 from
%  the National Institute of Standards website,
%  http://webbook.nist.gov/chemistry/fluid.
%  NAME can be 'propane', 'propaneperry', 'butane' and 'isobutane'.
%
%  See also QTESTSUBSTANCE.

% Simply export from http://webbook.nist.gov/chemistry/fluid to tab delimited
% data. The file will contain liquid (l) and vapor (v) properties.
% Columns for saturation properties - temperature increments:
% 1 Temperature (K),  2 Pressure (MPa),  3 Density (l, kg/m3),
% 4 Volume (l, m3/kg),  5 Internal Energy (l, kJ/kg),  6 Enthalpy (l, kJ/kg),
% 7 Entropy (l, J/g*K),  8 Cv (l, J/g*K),  9 Cp (l, J/g*K),
% 10 Sound Spd. (l, m/s),  11 Joule-Thomson (l, K/MPa),  12 Viscosity (l, Pa*s),
% 13 Therm. Cond. (l, W/m*K),  14 Surf. Tension (l, N/m), 15 Density (v, kg/m3),
% 16 Volume (v, m3/kg),  17 Internal Energy (v, kJ/kg),  18 Enthalpy (v, kJ/kg),
% 19 Entropy (v, J/g*K),  20 Cv (v, J/g*K),  21 Cp (v, J/g*K),
% 22 Sound Spd. (v, m/s),  23 Joule-Thomson (v, K/MPa),  24 Viscosity (v, Pa*s),
% 25 Therm. Cond. (v, W/m*K)

%global VERBOSE;

switch(name)
case {'propane', 'propaneperry'}
Tc = 369.82;

% Saturation properties - temperature increments.
% Data retrieved 2014-09-30
% Simply export data to tab delimited data
% column numbers see above
%
%Temperature (K)	Pressure (MPa)	Density (l, kg/m3)	Volume (l, m3/kg)	Internal Energy (l, kJ/kg)	Enthalpy (l, kJ/kg)	Entropy (l, J/g*K)	Cv (l, J/g*K)	Cp (l, J/g*K)	Sound Spd. (l, m/s)	Joule-Thomson (l, K/MPa)	Viscosity (l, Pa*s)	Therm. Cond. (l, W/m*K)	Surf. Tension (l, N/m)	Density (v, kg/m3)	Volume (v, m3/kg)	Internal Energy (v, kJ/kg)	Enthalpy (v, kJ/kg)	Entropy (v, J/g*K)	Cv (v, J/g*K)	Cp (v, J/g*K)	Sound Spd. (v, m/s)	Joule-Thomson (v, K/MPa)	Viscosity (v, Pa*s)	Therm. Cond. (v, W/m*K); ...
satdata = ...
[100	2.5330e-08	718.20	0.0013924	-168.55	-168.55	-1.0910	1.3238	1.9012	2030.4	-0.62852	0.0037803	0.20323	0.035435	1.3434e-06	7.4440e+05	360.27	379.13	4.3858	0.74794	0.93650	153.65	420.53	2.9792e-06	0.0024171; ...
110	3.4728e-07	708.03	0.0014124	-149.43	-149.43	-0.90878	1.3219	1.9233	1964.8	-0.61839	0.0022603	0.19916	0.033874	1.6744e-05	59724.	367.94	388.68	3.9831	0.78463	0.97319	160.39	308.20	3.2205e-06	0.0029439; ...
120	2.9622e-06	697.87	0.0014329	-130.09	-130.09	-0.74056	1.3229	1.9434	1896.2	-0.60874	0.0015032	0.19451	0.032320	0.00013092	7638.3	375.96	398.59	3.6651	0.81971	1.0083	166.83	233.46	3.4667e-06	0.0034998; ...
130	1.7600e-05	687.73	0.0014540	-110.56	-110.56	-0.58426	1.3253	1.9622	1827.2	-0.59904	0.0010805	0.18940	0.030775	0.00071805	1392.7	384.33	408.84	3.4111	0.85337	1.0420	172.99	181.79	3.7167e-06	0.0040849; ...
140	7.8928e-05	677.59	0.0014758	-90.847	-90.847	-0.43816	1.3290	1.9808	1758.6	-0.58882	0.00082234	0.18394	0.029239	0.0029904	334.41	393.02	419.41	3.2065	0.88602	1.0747	178.91	144.88	3.9700e-06	0.0046989; ...
150	0.00028325	667.43	0.0014983	-70.943	-70.943	-0.30085	1.3342	2.0001	1690.7	-0.57766	0.00065284	0.17821	0.027713	0.010019	99.813	402.02	430.29	3.0407	0.91821	1.1071	184.60	117.77	4.2258e-06	0.0053418; ...
160	0.00084980	657.22	0.0015216	-50.841	-50.839	-0.17112	1.3412	2.0208	1623.4	-0.56521	0.00053462	0.17230	0.026198	0.028195	35.467	411.32	441.46	2.9057	0.95045	1.1398	190.03	97.395	4.4832e-06	0.0060131; ...
170	0.0022035	646.94	0.0015457	-30.521	-30.518	-0.047937	1.3502	2.0436	1556.7	-0.55115	0.00044801	0.16625	0.024694	0.068881	14.518	420.90	452.89	2.7956	0.98328	1.1736	195.20	81.782	4.7415e-06	0.0067123; ...
180	0.0050673	636.56	0.0015709	-9.9619	-9.9539	0.069570	1.3615	2.0690	1490.5	-0.53518	0.00038195	0.16012	0.023203	0.14988	6.6720	430.73	464.54	2.7057	1.0171	1.2090	200.07	69.615	4.9999e-06	0.0074387; ...
190	0.010547	626.06	0.0015973	10.864	10.881	0.18217	1.3751	2.0974	1424.7	-0.51702	0.00032994	0.15397	0.021725	0.29641	3.3737	440.80	476.39	2.6322	1.0524	1.2467	204.61	59.995	5.2578e-06	0.0081917; ...
200	0.020194	615.40	0.0016250	31.988	32.021	0.29051	1.3912	2.1291	1359.3	-0.49635	0.00028793	0.14782	0.020262	0.54151	1.8467	451.08	488.37	2.5723	1.0894	1.2875	208.74	52.290	5.5148e-06	0.0089710; ...
210	0.036037	604.55	0.0016541	53.443	53.503	0.39519	1.4097	2.1646	1294.1	-0.47283	0.00025330	0.14172	0.018814	0.92597	1.0800	461.53	500.45	2.5235	1.1285	1.3318	212.43	46.045	5.7708e-06	0.0097770; ...
220	0.060583	593.47	0.0016850	75.266	75.368	0.49671	1.4307	2.2042	1229.1	-0.44601	0.00022428	0.13572	0.017383	1.4981	0.66752	472.13	512.57	2.4840	1.1697	1.3803	215.59	40.931	6.0262e-06	0.010611; ...
230	0.096787	582.12	0.0017179	97.494	97.660	0.59552	1.4541	2.2481	1164.3	-0.41538	0.00019964	0.12981	0.015970	2.3136	0.43224	482.83	524.67	2.4521	1.2133	1.4337	218.19	36.704	6.2821e-06	0.011477; ...
240	0.14801	570.45	0.0017530	120.17	120.43	0.69203	1.4798	2.2970	1099.5	-0.38021	0.00017847	0.12403	0.014578	3.4357	0.29106	493.60	536.68	2.4264	1.2594	1.4927	220.14	33.184	6.5401e-06	0.012378; ...
250	0.21798	558.40	0.0017908	143.33	143.72	0.78661	1.5077	2.3513	1034.8	-0.33958	0.00016010	0.11840	0.013206	4.9365	0.20257	504.40	548.56	2.4060	1.3080	1.5580	221.39	30.235	6.8027e-06	0.013323; ...
260	0.31070	545.90	0.0018318	167.03	167.60	0.87960	1.5379	2.4118	970.07	-0.29217	0.00014401	0.11293	0.011859	6.8985	0.14496	515.18	560.22	2.3897	1.3592	1.6309	221.88	27.757	7.0729e-06	0.014321; ...
270	0.43046	532.88	0.0018766	191.32	192.13	0.97132	1.5702	2.4796	905.14	-0.23616	0.00012979	0.10763	0.010537	9.4181	0.10618	525.89	571.60	2.3768	1.4129	1.7128	221.54	25.672	7.3552e-06	0.015389; ...
280	0.58173	519.23	0.0019259	216.26	217.38	1.0621	1.6046	2.5563	839.90	-0.16892	0.00011711	0.10252	0.0092437	12.610	0.079299	536.47	582.60	2.3664	1.4694	1.8060	220.30	23.923	7.6551e-06	0.016544; ...
290	0.76921	504.82	0.0019809	241.91	243.43	1.1522	1.6411	2.6446	774.19	-0.086512	0.00010569	0.097597	0.0079822	16.618	0.060175	546.82	593.11	2.3580	1.5287	1.9137	218.06	22.463	7.9800e-06	0.017814; ...
300	0.99780	489.48	0.0020430	268.36	270.40	1.2421	1.6799	2.7482	707.76	0.017115	9.5302e-05	0.092868	0.0067563	21.626	0.046242	556.86	603.00	2.3508	1.5905	2.0406	214.72	21.268	8.3399e-06	0.019236; ...
310	1.2726	472.98	0.0021142	295.73	298.43	1.3321	1.7212	2.8739	640.30	0.15178	8.5735e-05	0.088324	0.0055707	27.882	0.035865	566.42	612.07	2.3438	1.6531	2.1942	210.16	20.354	8.7494e-06	0.020863; ...
320	1.5992	454.98	0.0021979	324.18	327.70	1.4228	1.7654	3.0338	571.35	0.33451	7.6800e-05	0.083951	0.0044313	35.748	0.027973	575.25	619.98	2.3362	1.7180	2.3943	204.26	19.729	9.2300e-06	0.022776; ...
330	1.9835	434.92	0.0022993	353.94	358.50	1.5149	1.8134	3.2526	500.17	0.59757	6.8303e-05	0.079718	0.0033463	45.780	0.021844	582.96	626.29	2.3264	1.7922	2.6860	196.80	19.344	9.8173e-06	0.025121; ...
340	2.4320	411.87	0.0024280	385.45	391.35	1.6098	1.8670	3.5872	425.33	1.0100	6.0014e-05	0.075581	0.0023271	58.924	0.016971	588.97	630.25	2.3124	1.8839	3.1665	187.44	19.120	1.0574e-05	0.028187; ...
350	2.9527	383.88	0.0026050	419.52	427.21	1.7099	1.9335	4.2077	344.23	1.7479	5.1592e-05	0.071489	0.0013917	77.072	0.012975	592.13	630.44	2.2906	1.9998	4.1109	175.79	18.970	1.1635e-05	0.032683];

% isobaric properties - p = 1 Pa (for ideal gas cp)
% Data retrieved 2014-09-30, http://webbook.nist.gov/chemistry/fluid
%
%Temperature (K)	Pressure (MPa)	Density (kg/m3)	Volume (m3/kg)	Internal Energy (kJ/kg)	Enthalpy (kJ/kg)	Entropy (J/g*K)	Cv (J/g*K)	Cp (J/g*K)	Sound Spd. (m/s)	Joule-Thomson (K/MPa)	Viscosity (Pa*s)	Therm. Cond. (W/m*K)	Phase
p1Pa = ...
[120	1e-6	4.4196e-05	22627.	375.96	398.59	3.8699	0.81971	1.0083	166.83	233.45	3.4667e-06	0.0034998; ... vapor
130	1e-6	4.0796e-05	24512.	384.33	408.84	3.9519	0.85334	1.0419	173.00	181.75	3.7168e-06	0.0040849; ... vapor
140	1e-6	3.7882e-05	26398.	393.02	419.42	4.0303	0.88592	1.0745	178.93	144.77	3.9704e-06	0.0046992; ... vapor
150	1e-6	3.5357e-05	28283.	402.04	430.33	4.1055	0.91792	1.1065	184.64	117.55	4.2268e-06	0.0053426; ... vapor
160	1e-6	3.3147e-05	30169.	411.38	441.55	4.1780	0.94980	1.1384	190.15	97.010	4.4856e-06	0.0060152; ... vapor
170	1e-6	3.1197e-05	32054.	421.04	453.10	4.2479	0.98194	1.1705	195.47	81.164	4.7465e-06	0.0067169; ... vapor
180	1e-6	2.9464e-05	33940.	431.02	464.96	4.3158	1.0147	1.2032	200.62	68.710	5.0090e-06	0.0074478; ... vapor
190	1e-6	2.7913e-05	35826.	441.34	477.16	4.3817	1.0482	1.2368	205.60	58.761	5.2729e-06	0.0082078; ... vapor
200	1e-6	2.6517e-05	37711.	451.99	489.70	4.4460	1.0828	1.2714	210.42	50.698	5.5379e-06	0.0089969; ... vapor
210	1e-6	2.5255e-05	39597.	463.00	502.59	4.5089	1.1185	1.3070	215.11	44.082	5.8037e-06	0.0098153; ... vapor
220	1e-6	2.4107e-05	41482.	474.37	515.85	4.5706	1.1554	1.3439	219.66	38.595	6.0702e-06	0.010663; ... vapor
230	1e-6	2.3059e-05	43368.	486.11	529.48	4.6311	1.1934	1.3820	224.10	34.000	6.3371e-06	0.011539; ... vapor
240	1e-6	2.2098e-05	45253.	498.24	543.49	4.6908	1.2327	1.4212	228.42	30.119	6.6043e-06	0.012445; ... vapor
250	1e-6	2.1214e-05	47139.	510.77	557.90	4.7496	1.2731	1.4616	232.64	26.816	6.8715e-06	0.013380; ... vapor
260	1e-6	2.0398e-05	49024.	523.70	572.73	4.8077	1.3145	1.5030	236.76	23.988	7.1387e-06	0.014344; ... vapor
270	1e-6	1.9643e-05	50910.	537.06	587.97	4.8653	1.3568	1.5454	240.80	21.549	7.4056e-06	0.015337; ... vapor
280	1e-6	1.8941e-05	52796.	550.84	603.64	4.9222	1.4001	1.5886	244.76	19.436	7.6722e-06	0.016360; ... vapor
290	1e-6	1.8288e-05	54681.	565.06	619.74	4.9787	1.4440	1.6325	248.64	17.596	7.9382e-06	0.017411; ... vapor
300	1e-6	1.7678e-05	56567.	579.72	636.29	5.0348	1.4885	1.6771	252.45	15.985	8.2038e-06	0.018492; ... vapor
310	1e-6	1.7108e-05	58452.	594.83	653.29	5.0906	1.5336	1.7221	256.20	14.571	8.4686e-06	0.019602; ... vapor
320	1e-6	1.6573e-05	60338.	610.40	670.73	5.1460	1.5790	1.7675	259.89	13.325	8.7326e-06	0.020741; ... vapor
330	1e-6	1.6071e-05	62223.	626.41	688.64	5.2010	1.6246	1.8132	263.52	12.220	8.9957e-06	0.021909; ... vapor
340	1e-6	1.5598e-05	64109.	642.89	707.00	5.2559	1.6705	1.8590	267.11	11.238	9.2579e-06	0.023106; ... vapor
350	1e-6	1.5153e-05	65994.	659.82	725.82	5.3104	1.7163	1.9049	270.64	10.362	9.5190e-06	0.024333]; %	vapor


% Saturation pressure - psat < 80 Pa for T < 150
N.ps.Tfirst = 140;
N.v.Tlast = 330;
N.hvap.Tlast = N.v.Tlast;
N.jt.Tlast = N.v.Tlast;
N.cpg.Tlast = 310;
N.nug.Tlast = N.v.Tlast;

case 'isobutane'
Tc = 408.2;
N = struct();

% Saturation properties - temperature increments.
% Data retrieved 2014-10-03
%
%Temperature (K)	Pressure (MPa)	Density (l, kg/m3)	Volume (l, m3/kg)	Internal Energy (l, kJ/kg)	Enthalpy (l, kJ/kg)	Entropy (l, J/g*K)	Cv (l, J/g*K)	Cp (l, J/g*K)	Sound Spd. (l, m/s)	Joule-Thomson (l, K/MPa)	Viscosity (l, Pa*s)	Therm. Cond. (l, W/m*K)	Surf. Tension (l, N/m)	Density (v, kg/m3)	Volume (v, m3/kg)	Internal Energy (v, kJ/kg)	Enthalpy (v, kJ/kg)	Entropy (v, J/g*K)	Cv (v, J/g*K)	Cp (v, J/g*K)	Sound Spd. (v, m/s)	Joule-Thomson (v, K/MPa)	Viscosity (v, Pa*s)	Therm. Cond. (v, W/m*K)
satdata = ...
[200	0.0038135	657.71	0.0015204	45.216	45.222	0.34403	1.3626	1.9678	1389.1	-0.54013	0.00054715	0.12906	0.022082	0.13378	7.4749	431.13	459.64	2.4161	1.0952	1.2409	179.38	76.870	5.0796e-06	0.0080275; ...
205	0.0054294	652.74	0.0015320	55.098	55.107	0.39283	1.3753	1.9855	1358.6	-0.53024	0.00050216	0.12694	0.021447	0.18603	5.3754	436.56	465.75	2.3960	1.1159	1.2623	181.26	70.957	5.2047e-06	0.0084173; ...
210	0.0075808	647.75	0.0015438	65.070	65.082	0.44089	1.3883	2.0036	1328.4	-0.52001	0.00046245	0.12482	0.020813	0.25392	3.9383	442.07	471.93	2.3783	1.1369	1.2843	183.08	65.685	5.3292e-06	0.0088127; ...
215	0.010396	642.72	0.0015559	75.133	75.149	0.48825	1.4017	2.0222	1298.4	-0.50940	0.00042719	0.12269	0.020182	0.34069	2.9352	447.66	478.17	2.3628	1.1581	1.3067	184.82	60.972	5.4531e-06	0.0092137; ...
220	0.014023	637.65	0.0015683	85.289	85.311	0.53495	1.4154	2.0413	1268.6	-0.49839	0.00039573	0.12056	0.019552	0.44997	2.2224	453.32	484.48	2.3494	1.1797	1.3296	186.48	56.748	5.5763e-06	0.0096201; ...
225	0.018625	632.54	0.0015809	95.542	95.571	0.58103	1.4296	2.0609	1238.9	-0.48694	0.00036752	0.11844	0.018925	0.58573	1.7073	459.05	490.85	2.3378	1.2016	1.3532	188.06	52.952	5.6989e-06	0.010032; ...
230	0.024387	627.39	0.0015939	105.89	105.93	0.62653	1.4443	2.0811	1209.5	-0.47500	0.00034212	0.11632	0.018300	0.75229	1.3293	464.86	497.28	2.3280	1.2239	1.3774	189.56	49.534	5.8209e-06	0.010449; ...
235	0.031511	622.19	0.0016072	116.34	116.40	0.67149	1.4593	2.1018	1180.3	-0.46255	0.00031915	0.11421	0.017677	0.95433	1.0479	470.73	503.75	2.3198	1.2466	1.4022	190.96	46.450	5.9424e-06	0.010872; ...
240	0.040218	616.95	0.0016209	126.90	126.97	0.71593	1.4747	2.1231	1151.2	-0.44953	0.00029832	0.11210	0.017058	1.1969	0.83550	476.67	510.27	2.3130	1.2697	1.4278	192.25	43.661	6.0634e-06	0.011300; ...
245	0.050746	611.64	0.0016349	137.56	137.65	0.75991	1.4906	2.1451	1122.2	-0.43590	0.00027936	0.11002	0.016441	1.4853	0.67326	482.67	516.83	2.3076	1.2931	1.4542	193.45	41.135	6.1841e-06	0.011734; ...
250	0.063350	606.28	0.0016494	148.34	148.44	0.80344	1.5068	2.1678	1093.4	-0.42158	0.00026204	0.10794	0.015827	1.8253	0.54785	488.73	523.43	2.3034	1.3170	1.4813	194.52	38.843	6.3045e-06	0.012174; ...
255	0.078301	600.86	0.0016643	159.22	159.35	0.84655	1.5235	2.1912	1064.7	-0.40653	0.00024619	0.10589	0.015216	2.2230	0.44984	494.84	530.06	2.3003	1.3413	1.5094	195.48	36.761	6.4249e-06	0.012620; ...
260	0.095885	595.37	0.0016796	170.22	170.38	0.88927	1.5406	2.2153	1036.1	-0.39066	0.00023163	0.10386	0.014608	2.6848	0.37247	501.01	536.72	2.2983	1.3660	1.5383	196.32	34.866	6.5453e-06	0.013073; ...
265	0.11640	589.81	0.0016955	181.34	181.54	0.93164	1.5580	2.2402	1007.7	-0.37389	0.00021823	0.10185	0.014004	3.2175	0.31080	507.23	543.41	2.2972	1.3911	1.5682	197.02	33.140	6.6660e-06	0.013532; ...
270	0.14017	584.17	0.0017118	192.58	192.82	0.97368	1.5758	2.2660	979.29	-0.35612	0.00020587	0.099867	0.013404	3.8285	0.26120	513.50	550.11	2.2970	1.4166	1.5990	197.59	31.567	6.7873e-06	0.014000; ...
275	0.16751	578.45	0.0017288	203.95	204.24	1.0154	1.5940	2.2927	951.00	-0.33724	0.00019443	0.097912	0.012807	4.5253	0.22098	519.81	556.82	2.2975	1.4426	1.6310	198.01	30.133	6.9095e-06	0.014476; ...
280	0.19876	572.64	0.0017463	215.45	215.80	1.0569	1.6126	2.3203	922.77	-0.31712	0.00018383	0.095986	0.012215	5.3164	0.18810	526.16	563.54	2.2988	1.4689	1.6641	198.29	28.823	7.0328e-06	0.014961; ...
285	0.23427	566.72	0.0017645	227.08	227.49	1.0980	1.6315	2.3490	894.60	-0.29559	0.00017398	0.094091	0.011627	6.2104	0.16102	532.54	570.26	2.3007	1.4956	1.6984	198.40	27.629	7.1576e-06	0.015458; ...
290	0.27440	560.71	0.0017835	238.85	239.34	1.1390	1.6508	2.3788	866.47	-0.27248	0.00016480	0.092227	0.011044	7.2170	0.13856	538.96	576.98	2.3033	1.5227	1.7341	198.35	26.539	7.2844e-06	0.015966; ...
295	0.31952	554.58	0.0018032	250.76	251.34	1.1797	1.6704	2.4098	838.36	-0.24757	0.00015624	0.090398	0.010465	8.3463	0.11981	545.40	583.69	2.3063	1.5502	1.7712	198.13	25.545	7.4136e-06	0.016487; ...
300	0.37000	548.32	0.0018237	262.82	263.50	1.2203	1.6903	2.4422	810.25	-0.22061	0.00014822	0.088602	0.0098917	9.6096	0.10406	551.87	590.37	2.3099	1.5781	1.8100	197.74	24.641	7.5457e-06	0.017024; ...
305	0.42622	541.93	0.0018453	275.03	275.82	1.2607	1.7105	2.4760	782.13	-0.19130	0.00014070	0.086842	0.0093238	11.019	0.090751	558.35	597.03	2.3138	1.6063	1.8505	197.15	23.819	7.6815e-06	0.017578; ...
310	0.48858	535.39	0.0018678	287.40	288.32	1.3010	1.7311	2.5116	753.97	-0.15928	0.00013364	0.085118	0.0087616	12.589	0.079437	564.84	603.65	2.3182	1.6350	1.8931	196.37	23.074	7.8217e-06	0.018151; ...
315	0.55749	528.69	0.0018915	299.94	300.99	1.3411	1.7520	2.5490	725.75	-0.12409	0.00012697	0.083431	0.0082055	14.333	0.069770	571.33	610.23	2.3228	1.6641	1.9379	195.38	22.400	7.9670e-06	0.018748; ...
320	0.63335	521.81	0.0019164	312.64	313.86	1.3812	1.7732	2.5886	697.45	-0.085193	0.00012067	0.081781	0.0076559	16.269	0.061468	577.82	616.75	2.3277	1.6936	1.9854	194.17	21.794	8.1184e-06	0.019370; ...
325	0.71658	514.73	0.0019428	325.52	326.92	1.4212	1.7948	2.6307	669.03	-0.041930	0.00011469	0.080169	0.0071132	18.416	0.054302	584.29	623.20	2.3328	1.7234	2.0357	192.73	21.254	8.2772e-06	0.020022; ...
330	0.80761	507.43	0.0019707	338.59	340.19	1.4611	1.8167	2.6757	640.46	0.0065370	0.00010901	0.078595	0.0065779	20.795	0.048087	590.73	629.57	2.3381	1.7534	2.0895	191.05	20.778	8.4448e-06	0.020708; ...
335	0.90688	499.89	0.0020004	351.86	353.67	1.5011	1.8390	2.7241	611.71	0.061260	0.00010359	0.077059	0.0060505	23.434	0.042673	597.13	635.83	2.3434	1.7835	2.1471	189.11	20.370	8.6226e-06	0.021434; ...
340	1.0148	492.07	0.0020322	365.33	367.40	1.5411	1.8617	2.7767	582.74	0.12359	9.8394e-05	0.075561	0.0055315	26.361	0.037935	603.48	641.97	2.3487	1.8136	2.2095	186.90	20.032	8.8129e-06	0.022207; ...
345	1.1320	483.95	0.0020663	379.03	381.37	1.5812	1.8849	2.8342	553.50	0.19528	9.3404e-05	0.074101	0.0050216	29.612	0.033770	609.74	647.96	2.3540	1.8438	2.2781	184.40	19.767	9.0180e-06	0.023035; ...
350	1.2587	475.47	0.0021032	392.96	395.61	1.6214	1.9086	2.8980	523.94	0.27866	8.8587e-05	0.072679	0.0045214	33.230	0.030093	615.89	653.77	2.3590	1.8744	2.3552	181.59	19.577	9.2411e-06	0.023928];

% isobaric properties - p = 1 Pa (for ideal gas cp)
% Data retrieved 2014-10-03, http://webbook.nist.gov/chemistry/fluid
%
%Temperature (K)	Pressure (MPa)	Density (kg/m3)	Volume (m3/kg)	Internal Energy (kJ/kg)	Enthalpy (kJ/kg)	Entropy (J/g*K)	Cv (J/g*K)	Cp (J/g*K)	Sound Spd. (m/s)	Joule-Thomson (K/MPa)	Viscosity (Pa*s)	Therm. Cond. (W/m*K)	Phase
p1Pa = ...
[200	1e-6	3.4952e-05	28610.	431.39	460.00	3.5970	1.0929	1.2359	179.88	76.189	5.0857e-06	0.0080380;... vapor
205	1e-6	3.4100e-05	29326.	436.90	466.23	3.6278	1.1129	1.2560	181.92	70.153	5.2126e-06	0.0084314;... vapor
210	1e-6	3.3288e-05	30041.	442.52	472.56	3.6583	1.1331	1.2761	183.94	64.748	5.3392e-06	0.0088313;... vapor
215	1e-6	3.2514e-05	30756.	448.24	478.99	3.6886	1.1534	1.2965	185.93	59.893	5.4654e-06	0.0092377;... vapor
220	1e-6	3.1775e-05	31471.	454.05	485.52	3.7186	1.1739	1.3170	187.90	55.520	5.5913e-06	0.0096506;... vapor
225	1e-6	3.1069e-05	32187.	459.97	492.16	3.7485	1.1946	1.3377	189.84	51.568	5.7170e-06	0.010070;... vapor
230	1e-6	3.0393e-05	32902.	466.00	498.90	3.7781	1.2155	1.3586	191.77	47.988	5.8422e-06	0.010496;... vapor
235	1e-6	2.9747e-05	33617.	472.13	505.75	3.8075	1.2366	1.3797	193.66	44.737	5.9672e-06	0.010928;... vapor
240	1e-6	2.9127e-05	34332.	478.37	512.70	3.8368	1.2579	1.4010	195.54	41.778	6.0919e-06	0.011367;... vapor
245	1e-6	2.8533e-05	35048.	484.71	519.76	3.8659	1.2795	1.4225	197.40	39.078	6.2162e-06	0.011812;... vapor
250	1e-6	2.7962e-05	35763.	491.16	526.92	3.8949	1.3012	1.4443	199.23	36.610	6.3403e-06	0.012264;... vapor
255	1e-6	2.7414e-05	36478.	497.72	534.20	3.9237	1.3231	1.4662	201.05	34.349	6.4640e-06	0.012722;... vapor
260	1e-6	2.6886e-05	37193.	504.39	541.59	3.9524	1.3453	1.4883	202.85	32.273	6.5874e-06	0.013187;... vapor
265	1e-6	2.6379e-05	37909.	511.18	549.08	3.9809	1.3676	1.5106	204.63	30.364	6.7106e-06	0.013658;... vapor
270	1e-6	2.5891e-05	38624.	518.07	556.69	4.0094	1.3901	1.5331	206.39	28.606	6.8334e-06	0.014136;... vapor
275	1e-6	2.5420e-05	39339.	525.08	564.42	4.0377	1.4128	1.5558	208.14	26.984	6.9559e-06	0.014620;... vapor
280	1e-6	2.4966e-05	40054.	532.20	572.25	4.0659	1.4356	1.5786	209.87	25.485	7.0781e-06	0.015111;... vapor
285	1e-6	2.4528e-05	40770.	539.43	580.20	4.0941	1.4586	1.6016	211.59	24.098	7.2000e-06	0.015608;... vapor
290	1e-6	2.4105e-05	41485.	546.78	588.27	4.1221	1.4817	1.6247	213.28	22.812	7.3216e-06	0.016112;... vapor
295	1e-6	2.3697e-05	42200.	554.25	596.45	4.1501	1.5049	1.6480	214.97	21.618	7.4429e-06	0.016622;... vapor
300	1e-6	2.3302e-05	42915.	561.83	604.75	4.1780	1.5283	1.6713	216.64	20.509	7.5639e-06	0.017139;... vapor
305	1e-6	2.2920e-05	43631.	569.53	613.16	4.2058	1.5517	1.6948	218.30	19.476	7.6846e-06	0.017662;... vapor
310	1e-6	2.2550e-05	44346.	577.35	621.70	4.2336	1.5753	1.7183	219.94	18.514	7.8051e-06	0.018192;... vapor
315	1e-6	2.2192e-05	45061.	585.29	630.35	4.2613	1.5988	1.7419	221.57	17.616	7.9252e-06	0.018728;... vapor
320	1e-6	2.1845e-05	45776.	593.34	639.12	4.2889	1.6225	1.7655	223.19	16.778	8.0451e-06	0.019270;... vapor
325	1e-6	2.1509e-05	46492.	601.51	648.00	4.3164	1.6462	1.7892	224.79	15.994	8.1646e-06	0.019819;... vapor
330	1e-6	2.1183e-05	47207.	609.80	657.01	4.3439	1.6699	1.8129	226.39	15.260	8.2839e-06	0.020375;... vapor
335	1e-6	2.0867e-05	47922.	618.21	666.13	4.3714	1.6936	1.8367	227.97	14.573	8.4029e-06	0.020937;... vapor
340	1e-6	2.0560e-05	48638.	626.74	675.37	4.3988	1.7173	1.8604	229.54	13.928	8.5217e-06	0.021506;... vapor
345	1e-6	2.0262e-05	49353.	635.38	684.74	4.4261	1.7410	1.8841	231.10	13.323	8.6401e-06	0.022081;... vapor
350	1e-6	1.9973e-05	50068.	644.15	694.22	4.4534	1.7647	1.9078	232.65	12.755	8.7583e-06	0.022662]; % vapor

case 'butane'
Tc = 425.2;
N = struct();

% Saturation properties - temperature increments.
% Data retrieved 2014-10-03
%Temperature (K)	Pressure (MPa)	Density (l, kg/m3)	Volume (l, m3/kg)	Internal Energy (l, kJ/kg)	Enthalpy (l, kJ/kg)	Entropy (l, J/g*K)	Cv (l, J/g*K)	Cp (l, J/g*K)	Sound Spd. (l, m/s)	Joule-Thomson (l, K/MPa)	Viscosity (l, Pa*s)	Therm. Cond. (l, W/m*K)	Surf. Tension (l, N/m)	Density (v, kg/m3)	Volume (v, m3/kg)	Internal Energy (v, kJ/kg)	Enthalpy (v, kJ/kg)	Entropy (v, J/g*K)	Cv (v, J/g*K)	Cp (v, J/g*K)	Sound Spd. (v, m/s)	Joule-Thomson (v, K/MPa)	Viscosity (v, Pa*s)	Therm. Cond. (v, W/m*K)
satdata = ...
[150	8.5728e-06	720.88	0.0013872	-59.926	-59.926	-0.25504	1.4423	1.9861	1729.8	-0.56311	0.0013698	0.17119	0.031312	0.00039953	2502.9	401.76	423.21	2.9659	1.0152	1.1582	156.46	245.68	3.7091e-06	0.0055793; ...
160	3.4612e-05	711.57	0.0014054	-40.014	-40.014	-0.12653	1.4438	1.9966	1669.2	-0.55639	0.0010552	0.16722	0.029885	0.0015124	661.21	412.06	434.95	2.8420	1.0471	1.1902	161.28	195.21	3.9652e-06	0.0060993; ...
170	0.00011616	702.24	0.0014240	-19.987	-19.987	-0.0051266	1.4473	2.0091	1610.1	-0.54850	0.00084468	0.16300	0.028472	0.0047778	209.30	422.68	446.99	2.7418	1.0782	1.2215	165.94	157.83	4.2205e-06	0.0066513; ...
180	0.00033476	692.88	0.0014433	0.17609	0.17658	0.11012	1.4531	2.0240	1552.1	-0.53928	0.00069458	0.15858	0.027073	0.013008	76.876	433.59	459.33	2.6609	1.1093	1.2528	170.43	129.55	4.4747e-06	0.0072351; ...
190	0.00084976	683.47	0.0014631	20.501	20.502	0.22001	1.4617	2.0416	1494.9	-0.52861	0.00058269	0.15402	0.025689	0.031301	31.948	444.79	471.94	2.5960	1.1411	1.2850	174.75	107.75	4.7277e-06	0.0078506; ...
200	0.0019390	673.99	0.0014837	41.017	41.020	0.32523	1.4732	2.0621	1438.2	-0.51637	0.00049650	0.14936	0.024320	0.067923	14.723	456.27	484.82	2.5442	1.1739	1.3186	178.87	90.683	4.9792e-06	0.0084974; ...
210	0.0040426	664.44	0.0015050	61.753	61.759	0.42640	1.4877	2.0858	1382.0	-0.50244	0.00042838	0.14463	0.022967	0.13510	7.4021	468.02	497.94	2.5035	1.2082	1.3541	182.78	77.150	5.2290e-06	0.0091753; ...
220	0.0078045	654.77	0.0015272	82.741	82.753	0.52403	1.5050	2.1127	1326.2	-0.48672	0.00037345	0.13988	0.021630	0.24959	4.0066	480.04	511.30	2.4720	1.2442	1.3920	186.44	66.298	5.4768e-06	0.0098841; ...
230	0.014106	644.99	0.0015504	104.01	104.04	0.61859	1.5251	2.1429	1270.8	-0.46909	0.00032838	0.13513	0.020310	0.43303	2.3093	492.30	524.88	2.4483	1.2821	1.4325	189.81	57.513	5.7226e-06	0.010624; ...
240	0.024086	635.06	0.0015747	125.60	125.64	0.71046	1.5478	2.1765	1215.6	-0.44938	0.00029087	0.13042	0.019007	0.71204	1.4044	504.81	538.64	2.4313	1.3221	1.4760	192.87	50.343	5.9664e-06	0.011395; ...
250	0.039153	624.95	0.0016001	147.54	147.60	0.80001	1.5730	2.2133	1160.9	-0.42740	0.00025926	0.12577	0.017723	1.1182	0.89430	517.55	552.57	2.4199	1.3640	1.5226	195.57	44.450	6.2087e-06	0.012197; ...
260	0.060978	614.65	0.0016270	169.85	169.95	0.88753	1.6005	2.2536	1106.4	-0.40288	0.00023232	0.12119	0.016457	1.6880	0.59243	530.50	566.63	2.4132	1.4080	1.5726	197.86	39.578	6.4502e-06	0.013034; ...
270	0.091481	604.11	0.0016553	192.58	192.73	0.97330	1.6301	2.2974	1052.2	-0.37548	0.00020913	0.11670	0.015211	2.4629	0.40603	543.65	580.79	2.4106	1.4538	1.6262	199.71	35.530	6.6919e-06	0.013906; ...
280	0.13282	593.29	0.0016855	215.75	215.97	1.0576	1.6615	2.3447	998.26	-0.34471	0.00018897	0.11232	0.013986	3.4896	0.28657	556.97	595.03	2.4114	1.5015	1.6835	201.08	32.154	6.9353e-06	0.014818; ...
290	0.18734	582.17	0.0017177	239.39	239.71	1.1406	1.6947	2.3959	944.51	-0.30993	0.00017128	0.10806	0.012783	4.8208	0.20743	570.45	609.31	2.4150	1.5508	1.7450	201.90	29.330	7.1826e-06	0.015775; ...
300	0.25760	570.68	0.0017523	263.54	264.00	1.2225	1.7293	2.4512	890.88	-0.27027	0.00015563	0.10393	0.011603	6.5164	0.15346	584.05	623.58	2.4211	1.6018	1.8111	202.15	26.968	7.4364e-06	0.016784; ...
310	0.34628	558.77	0.0017897	288.24	288.86	1.3035	1.7654	2.5112	837.29	-0.22453	0.00014167	0.099944	0.010447	8.6450	0.11567	597.74	637.79	2.4291	1.6542	1.8825	201.76	24.994	7.7001e-06	0.017855; ...
320	0.45624	546.36	0.0018303	313.51	314.35	1.3837	1.8027	2.5766	783.62	-0.17103	0.00012909	0.096103	0.0093166	11.287	0.088597	611.48	651.91	2.4386	1.7080	1.9603	200.69	23.353	7.9782e-06	0.018999; ...
330	0.59045	533.38	0.0018749	339.41	340.52	1.4635	1.8412	2.6485	729.73	-0.10739	0.00011768	0.092413	0.0082141	14.540	0.068778	625.23	665.84	2.4493	1.7632	2.0459	198.85	22.001	8.2761e-06	0.020233; ...
340	0.75201	519.69	0.0019242	365.98	367.42	1.5429	1.8811	2.7287	675.39	-0.030125	0.00010722	0.088879	0.0071413	18.522	0.053989	638.93	679.53	2.4609	1.8197	2.1416	196.17	20.907	8.6007e-06	0.021576; ...
350	0.94418	505.18	0.0019795	393.28	395.14	1.6222	1.9223	2.8197	620.37	0.066051	9.7559e-05	0.085498	0.0061009	23.389	0.042755	652.48	692.84	2.4727	1.8770	2.2505	192.54	20.061	8.9610e-06	0.023058];

% isobaric properties - p = 1 Pa (for ideal gas cp)
% Data retrieved 2014-10-03, http://webbook.nist.gov/chemistry/fluid
%Temperature (K)	Pressure (MPa)	Density (kg/m3)	Volume (m3/kg)	Internal Energy (kJ/kg)	Enthalpy (kJ/kg)	Entropy (J/g*K)	Cv (J/g*K)	Cp (J/g*K)	Sound Spd. (m/s)	Joule-Thomson (K/MPa)	Viscosity (Pa*s)	Therm. Cond. (W/m*K)	Phase
p1Pa = ...
[180	1e-6	3.8836e-05	25749.	433.63	459.38	3.4928	1.1089	1.2519	170.50	129.41	4.4758e-06	0.0072358;... vapor
190	1e-6	3.6792e-05	27180.	444.88	472.05	3.5613	1.1401	1.2832	174.90	107.51	4.7299e-06	0.0078522;... vapor
200	1e-6	3.4952e-05	28610.	456.44	485.05	3.6279	1.1722	1.3152	179.17	90.306	4.9832e-06	0.0085006;... vapor
210	1e-6	3.3288e-05	30041.	468.32	498.36	3.6929	1.2053	1.3484	183.32	76.597	5.2358e-06	0.0091810;... vapor
220	1e-6	3.1775e-05	31471.	480.55	512.02	3.7564	1.2398	1.3828	187.36	65.530	5.4876e-06	0.0098936;... vapor
230	1e-6	3.0393e-05	32902.	493.12	526.02	3.8187	1.2755	1.4186	191.29	56.498	5.7385e-06	0.010638;... vapor
240	1e-6	2.9127e-05	34332.	506.06	540.39	3.8798	1.3127	1.4557	195.13	49.052	5.9887e-06	0.011415;... vapor
250	1e-6	2.7962e-05	35763.	519.38	555.14	3.9400	1.3511	1.4942	198.87	42.861	6.2381e-06	0.012224;... vapor
260	1e-6	2.6886e-05	37193.	533.09	570.28	3.9994	1.3908	1.5339	202.53	37.673	6.4867e-06	0.013064;... vapor
270	1e-6	2.5891e-05	38624.	547.20	585.82	4.0581	1.4316	1.5747	206.11	33.294	6.7344e-06	0.013937;... vapor
280	1e-6	2.4966e-05	40054.	561.72	601.78	4.1161	1.4734	1.6164	209.63	29.574	6.9814e-06	0.014842;... vapor
290	1e-6	2.4105e-05	41485.	576.67	618.16	4.1735	1.5160	1.6591	213.07	26.395	7.2276e-06	0.015779;... vapor
300	1e-6	2.3302e-05	42915.	592.05	634.96	4.2305	1.5594	1.7024	216.45	23.664	7.4730e-06	0.016749;... vapor
310	1e-6	2.2550e-05	44346.	607.86	652.21	4.2870	1.6033	1.7463	219.78	21.305	7.7176e-06	0.017750;... vapor
320	1e-6	2.1845e-05	45776.	624.11	669.89	4.3432	1.6476	1.7906	223.05	19.257	7.9614e-06	0.018783;... vapor
330	1e-6	2.1183e-05	47207.	640.81	688.02	4.3990	1.6922	1.8353	226.27	17.472	8.2045e-06	0.019848;... vapor
340	1e-6	2.0560e-05	48638.	657.96	706.60	4.4544	1.7370	1.8800	229.44	15.908	8.4468e-06	0.020946;... vapor
350	1e-6	1.9973e-05	50068.	675.55	725.62	4.5096	1.7818	1.9249	232.57	14.534	8.6883e-06	0.022075;... vapor
360	1e-6	1.9418e-05	51499.	693.60	745.09	4.5644	1.8266	1.9697	235.65	13.321	8.9291e-06	0.023237;... vapor
370	1e-6	1.8893e-05	52929.	712.08	765.01	4.6190	1.8713	2.0143	238.70	12.246	9.1692e-06	0.024431;... vapor
380	1e-6	1.8396e-05	54360.	731.02	785.38	4.6733	1.9157	2.0587	241.70	11.290	9.4085e-06	0.025656;... vapor
390	1e-6	1.7924e-05	55790.	750.40	806.19	4.7274	1.9598	2.1029	244.67	10.436	9.6471e-06	0.026914;... vapor
400	1e-6	1.7476e-05	57221.	770.21	827.44	4.7811	2.0036	2.1467	247.60	9.6710	9.8849e-06	0.028204]; % vapor

case 'nitrogen'
Tc = 126.192;
N = struct();

% Saturation properties - temperature increments.
% Data retrieved 2014-10-21, http://webbook.nist.gov/chemistry/fluid

%Temperature (K)	Pressure (MPa)	Density (l, kg/m3)	Volume (l, m3/kg)	Internal Energy (l, kJ/kg)	Enthalpy (l, kJ/kg)	Entropy (l, J/g*K)	Cv (l, J/g*K)	Cp (l, J/g*K)	Sound Spd. (l, m/s)	Joule-Thomson (l, K/MPa)	Viscosity (l, Pa*s)	Therm. Cond. (l, W/m*K)	Surf. Tension (l, N/m)	Density (v, kg/m3)	Volume (v, m3/kg)	Internal Energy (v, kJ/kg)	Enthalpy (v, kJ/kg)	Entropy (v, J/g*K)	Cv (v, J/g*K)	Cp (v, J/g*K)	Sound Spd. (v, m/s)	Joule-Thomson (v, K/MPa)	Viscosity (v, Pa*s)	Therm. Cond. (v, W/m*K)
satdata = ...
[65	0.017404	859.60	0.0011633	-147.05	-147.03	2.4834	1.1634	2.0034	976.36	-0.39833	0.00028011	0.17315	0.011789	0.91308	1.0952	47.474	66.536	5.7690	0.75174	1.0633	163.20	38.268	4.5084e-06	0.0063374; ...
70	0.038545	838.51	0.0011926	-137.02	-136.97	2.6321	1.1297	2.0145	925.74	-0.37947	0.00021988	0.16184	0.010589	1.8960	0.52743	50.769	71.098	5.6045	0.75805	1.0816	168.42	32.837	4.8792e-06	0.0067968; ...
75	0.076043	816.67	0.0012245	-126.92	-126.83	2.7714	1.0981	2.0311	875.28	-0.35506	0.00017675	0.15087	0.0094170	3.5404	0.28245	53.838	75.316	5.4667	0.76649	1.1080	172.95	28.707	5.2557e-06	0.0072706; ...
80	0.13687	793.94	0.0012595	-116.75	-116.58	2.9028	1.0691	2.0555	824.36	-0.32322	0.00014505	0.14020	0.0082740	6.0894	0.16422	56.622	79.099	5.3487	0.77733	1.1449	176.72	25.490	5.6413e-06	0.0077802; ...
85	0.22886	770.13	0.0012985	-106.46	-106.16	3.0277	1.0429	2.0906	772.44	-0.28135	0.00012111	0.12993	0.0071627	9.8241	0.10179	59.056	82.352	5.2454	0.79094	1.1957	179.68	22.923	6.0405e-06	0.0083518; ...
90	0.36046	745.02	0.0013422	-96.001	-95.517	3.1473	1.0196	2.1407	719.01	-0.22564	0.00010253	0.11989	0.0060858	15.079	0.066317	61.065	84.970	5.1527	0.80785	1.2655	181.78	20.823	6.4592e-06	0.0090210; ...
95	0.54052	718.26	0.0013922	-85.324	-84.571	3.2630	0.99956	2.2126	663.50	-0.15025	8.7656e-05	0.11009	0.0050469	22.272	0.044900	62.559	86.828	5.0672	0.82877	1.3628	182.99	19.057	6.9056e-06	0.0098408; ...
100	0.77827	689.35	0.0014506	-74.338	-73.209	3.3761	0.98316	2.3180	605.23	-0.045743	7.5375e-05	0.10050	0.0040504	31.961	0.031288	63.416	87.766	4.9858	0.85481	1.5026	183.25	17.523	7.3920e-06	0.010893; ...
105	1.0833	657.52	0.0015209	-62.915	-61.268	3.4882	0.97148	2.4789	543.30	0.10414	6.4882e-05	0.091091	0.0031022	44.959	0.022243	63.462	87.557	4.9055	0.88744	1.7139	182.51	16.132	7.9386e-06	0.012314; ...
110	1.4658	621.45	0.0016091	-50.845	-48.486	3.6015	0.96674	2.7433	476.44	0.33023	5.5566e-05	0.081788	0.0022107	62.579	0.015980	62.412	85.835	4.8226	0.92835	2.0618	180.76	14.812	8.5822e-06	0.014350; ...
115	1.9370	578.70	0.0017280	-37.736	-34.389	3.7198	0.97416	3.2403	402.67	0.69974	4.6895e-05	0.072515	0.0013887	87.294	0.011456	59.721	81.911	4.7311	0.98957	2.7490	177.75	13.409	9.4010e-06	0.017541; ...
120	2.5106	523.36	0.0019107	-22.667	-17.870	3.8514	1.0106	4.5076	317.33	1.4037	3.8206e-05	0.063318	065908	125.09	0.0079943	54.102	74.173	4.6185	1.0985	4.6309	172.61	11.643	1.0611e-05	0.023495];

% isobaric properties - p = 1 Pa (for ideal gas cp)
% Data retrieved 2014-10-21, http://webbook.nist.gov/chemistry/fluid

%Temperature (K)	Pressure (MPa)	Density (kg/m3)	Volume (m3/kg)	Internal Energy (kJ/kg)	Enthalpy (kJ/kg)	Entropy (J/g*K)	Cv (J/g*K)	Cp (J/g*K)	Sound Spd. (m/s)	Joule-Thomson (K/MPa)	Viscosity (Pa*s)	Therm. Cond. (W/m*K)	Phase
p1Pa = ...
[70	1e-6	4.8132e-05	20776.	51.649	72.426	8.7513	0.74208	1.0389	170.55	32.158	4.8530e-06	0.0070050; ... vapor
80	1e-6	4.2115e-05	23744.	59.070	82.815	8.8900	0.74209	1.0389	182.32	24.400	5.5563e-06	0.0080202; ... vapor
90	1e-6	3.7436e-05	26712.	66.491	93.204	9.0124	0.74210	1.0389	193.38	19.380	6.2442e-06	0.0090132; ... vapor
100	1e-6	3.3692e-05	29680.	73.912	103.59	9.1219	0.74211	1.0389	203.84	15.904	6.9167e-06	0.0099841; ... vapor
110	1e-6	3.0629e-05	32648.	81.333	113.98	9.2209	0.74213	1.0389	213.79	13.372	7.5742e-06	0.010933; ... vapor
120	1e-6	2.8077e-05	35616.	88.755	124.37	9.3113	0.74214	1.0389	223.29	11.453	8.2170e-06	0.011861; ... vapor
130	1e-6	2.5917e-05	38585.	96.176	134.76	9.3945	0.74215	1.0390	232.41	9.9518	8.8458e-06	0.012769; ... vapor
140	1e-6	2.4066e-05	41553.	103.60	145.15	9.4714	0.74216	1.0390	241.18	8.7481	9.4610e-06	0.013657; ... vapor
150	1e-6	2.2462e-05	44521.	111.02	155.54	9.5431	0.74218	1.0390	249.65	7.7625	1.0063e-05	0.014527; ... vapor
160	1e-6	2.1058e-05	47489.	118.44	165.93	9.6102	0.74219	1.0390	257.84	6.9414	1.0653e-05	0.015379; ... vapor
170	1e-6	1.9819e-05	50457.	125.86	176.32	9.6732	0.74220	1.0390	265.77	6.2472	1.1231e-05	0.016213; ... vapor
180	1e-6	1.8718e-05	53425.	133.29	186.71	9.7326	0.74222	1.0390	273.47	5.6531	1.1798e-05	0.017032; ... vapor
190	1e-6	1.7733e-05	56393.	140.71	197.10	9.7887	0.74223	1.0390	280.97	5.1391	1.2354e-05	0.017835; ... vapor
200	1e-6	1.6846e-05	59361.	148.13	207.49	9.8420	0.74225	1.0391	288.27	4.6902	1.2900e-05	0.018623; ... vapor
210	1e-6	1.6044e-05	62329.	155.55	217.88	9.8927	0.74227	1.0391	295.38	4.2950	1.3436e-05	0.019397; ... vapor
220	1e-6	1.5315e-05	65297.	162.98	228.27	9.9411	0.74229	1.0391	302.33	3.9444	1.3963e-05	0.020158; ... vapor
230	1e-6	1.4649e-05	68265.	170.40	238.66	9.9873	0.74232	1.0391	309.13	3.6314	1.4480e-05	0.020905; ... vapor
240	1e-6	1.4038e-05	71233.	177.82	249.05	10.031	0.74236	1.0392	315.77	3.3503	1.4989e-05	0.021641; ... vapor
250	1e-6	1.3477e-05	74201.	185.25	259.45	10.074	0.74240	1.0392	322.28	3.0966	1.5490e-05	0.022365; ... vapor
260	1e-6	1.2959e-05	77169.	192.67	269.84	10.115	0.74246	1.0393	328.66	2.8665	1.5983e-05	0.023077; ... vapor
270	1e-6	1.2479e-05	80137.	200.10	280.23	10.154	0.74254	1.0393	334.92	2.6569	1.6468e-05	0.023779; ... vapor
280	1e-6	1.2033e-05	83105.	207.52	290.63	10.192	0.74263	1.0394	341.06	2.4651	1.6946e-05	0.024471; ... vapor
290	1e-6	1.1618e-05	86073.	214.95	301.02	10.228	0.74276	1.0396	347.08	2.2891	1.7417e-05	0.025154; ... vapor
300	1e-6	1.1231e-05	89041.	222.38	311.42	10.263	0.74292	1.0397	353.01	2.1270	1.7882e-05	0.025828; ... vapor
310	1e-6	1.0868e-05	92009.	229.81	321.82	10.298	0.74311	1.0399	358.83	1.9772	1.8339e-05	0.026493; ... vapor
320	1e-6	1.0529e-05	94977.	237.24	332.22	10.331	0.74334	1.0401	364.55	1.8384	1.8791e-05	0.027150; ... vapor
330	1e-6	1.0210e-05	97945.	244.67	342.62	10.363	0.74363	1.0404	370.19	1.7095	1.9237e-05	0.027800]; %	vapor

N.v.Tlast = 110;
N.cpg.Tlast = 110;
N.jt.Tlast = 110;
N.hvap.Tlast = 101;
N.kg.Tlast = 110;
N.nug.Tlast = 110;
N.sigma.Tlast = 115;

case {'R142b', 'r142b'}
Tc = 410.3;
N =struct();

% Data for R142b
% Retrieved from https://webbook.nist.gov/chemistry/fluid on 2020-12-18
% Saturation properties - temperature increments
% Simply export the tap-separated data.

%Temperature (K)	Pressure (MPa)	Density (l, kg/m3)	Volume (l, m3/kg)	Internal Energy (l, kJ/kg)	Enthalpy (l, kJ/kg)	Entropy (l, J/g*K)	Cv (l, J/g*K)	Cp (l, J/g*K)	Sound Spd. (l, m/s)	Joule-Thomson (l, K/MPa)	Viscosity (l, Pa*s)	Therm. Cond. (l, W/m*K)	Surf. Tension (l, N/m)	Density (v, kg/m3)	Volume (v, m3/kg)	Internal Energy (v, kJ/kg)	Enthalpy (v, kJ/kg)	Entropy (v, J/g*K)	Cv (v, J/g*K)	Cp (v, J/g*K)	Sound Spd. (v, m/s)	Joule-Thomson (v, K/MPa)	Viscosity (v, Pa*s)	Therm. Cond. (v, W/m*K)
satdata = ...
[220.00	0.011101	1288.3	0.00077621	136.13	136.14	0.74080	0.76832	1.1558	995.78	-0.43010	0.00060865	0.11111	0.021694	0.61531	1.6252	364.73	382.77	1.8619	0.60588	0.69364	143.06	92.022	7.6415e-06	0.0065691;...
225.00	0.015025	1277.8	0.00078261	141.92	141.93	0.76685	0.77494	1.1631	971.28	-0.42204	0.00056478	0.10916	0.021004	0.81608	1.2254	367.62	386.03	1.8517	0.61751	0.70642	144.30	83.865	7.8169e-06	0.0068305;...
230.00	0.020025	1267.2	0.00078917	147.76	147.77	0.79249	0.78160	1.1708	947.16	-0.41343	0.00052544	0.10721	0.020318	1.0667	0.93750	370.53	389.31	1.8426	0.62927	0.71951	145.49	76.720	7.9918e-06	0.0070970;...
235.00	0.026309	1256.5	0.00079587	153.63	153.65	0.81775	0.78830	1.1789	923.37	-0.40423	0.00049000	0.10526	0.019636	1.3755	0.72700	373.48	392.60	1.8346	0.64117	0.73294	146.61	70.431	8.1662e-06	0.0073684;...
240.00	0.034108	1245.7	0.00080274	159.54	159.57	0.84264	0.79504	1.1873	899.90	-0.39443	0.00045791	0.10331	0.018958	1.7518	0.57083	376.44	395.91	1.8274	0.65320	0.74673	147.66	64.873	8.3402e-06	0.0076449;...
245.00	0.043673	1234.9	0.00080979	165.49	165.53	0.86720	0.80181	1.1960	876.72	-0.38396	0.00042874	0.10136	0.018284	2.2056	0.45339	379.43	399.23	1.8211	0.66536	0.76087	148.64	59.942	8.5136e-06	0.0079265;...
250.00	0.055279	1223.9	0.00081703	171.49	171.54	0.89143	0.80862	1.2051	853.79	-0.37279	0.00040211	0.099420	0.017615	2.7474	0.36398	382.44	402.56	1.8155	0.67764	0.77540	149.53	55.554	8.6867e-06	0.0082133;...
255.00	0.069220	1212.9	0.00082447	177.54	177.59	0.91537	0.81545	1.2145	831.11	-0.36085	0.00037772	0.097485	0.016950	3.3888	0.29509	385.46	405.89	1.8107	0.69002	0.79031	150.35	51.637	8.8596e-06	0.0085055;...
260.00	0.085811	1201.7	0.00083214	183.63	183.70	0.93902	0.82232	1.2243	808.64	-0.34809	0.00035530	0.095560	0.016289	4.1419	0.24144	388.50	409.22	1.8064	0.70251	0.80562	151.08	48.133	9.0323e-06	0.0088034;...
265.00	0.10539	1190.4	0.00084004	189.76	189.85	0.96241	0.82921	1.2345	786.37	-0.33443	0.00033463	0.093645	0.015634	5.0197	0.19922	391.55	412.55	1.8028	0.71508	0.82135	151.71	44.992	9.2051e-06	0.0091072;...
270.00	0.12829	1179.0	0.00084819	195.95	196.06	0.98555	0.83613	1.2451	764.28	-0.31977	0.00031552	0.091742	0.014983	6.0361	0.16567	394.61	415.87	1.7996	0.72773	0.83752	152.25	42.170	9.3783e-06	0.0094173;...
275.00	0.15490	1167.4	0.00085662	202.19	202.32	1.0084	0.84307	1.2561	742.34	-0.30402	0.00029781	0.089854	0.014337	7.2060	0.13877	397.68	419.18	1.7970	0.74044	0.85415	152.68	39.633	9.5521e-06	0.0097343;...
280.00	0.18560	1155.6	0.00086535	208.48	208.64	1.0311	0.85004	1.2676	720.55	-0.28707	0.00028136	0.087980	0.013696	8.5449	0.11703	400.75	422.47	1.7948	0.75319	0.87126	153.01	37.348	9.7269e-06	0.010059;...
285.00	0.22078	1143.6	0.00087440	214.83	215.02	1.0536	0.85703	1.2796	698.87	-0.26876	0.00026603	0.086124	0.013060	10.070	0.099306	403.82	425.75	1.7930	0.76599	0.88891	153.23	35.289	9.9031e-06	0.010391;...
290.00	0.26086	1131.5	0.00088380	221.24	221.47	1.0759	0.86405	1.2920	677.30	-0.24894	0.00025172	0.084285	0.012430	11.799	0.084752	406.90	429.00	1.7915	0.77882	0.90713	153.32	33.433	1.0081e-05	0.010733;...
295.00	0.30625	1119.1	0.00089358	227.70	227.97	1.0980	0.87110	1.3051	655.82	-0.22743	0.00023834	0.082465	0.011806	13.752	0.072717	409.96	432.23	1.7904	0.79166	0.92600	153.30	31.759	1.0262e-05	0.011084;...
300.00	0.35741	1106.5	0.00090377	234.22	234.55	1.1199	0.87817	1.3188	634.41	-0.20400	0.00022579	0.080666	0.011187	15.950	0.062696	413.02	435.43	1.7895	0.80452	0.94558	153.15	30.249	1.0445e-05	0.011447;...
305.00	0.41477	1093.6	0.00091442	240.81	241.19	1.1417	0.88528	1.3332	613.05	-0.17838	0.00021400	0.078888	0.010574	18.416	0.054300	416.06	438.59	1.7889	0.81740	0.96598	152.86	28.887	1.0632e-05	0.011823;...
310.00	0.47879	1080.4	0.00092556	247.47	247.91	1.1634	0.89242	1.3485	591.73	-0.15027	0.00020291	0.077132	0.0099674	21.176	0.047223	419.09	441.70	1.7885	0.83029	0.98732	152.44	27.661	1.0824e-05	0.012213;...
315.00	0.54995	1066.9	0.00093726	254.19	254.70	1.1849	0.89961	1.3646	570.43	-0.11928	0.00019244	0.075399	0.0093672	24.258	0.041224	422.10	444.77	1.7883	0.84320	1.0098	151.86	26.559	1.1022e-05	0.012619;...
320.00	0.62872	1053.1	0.00094956	260.98	261.58	1.2063	0.90684	1.3818	549.13	-0.084961	0.00018254	0.073691	0.0087737	27.693	0.036110	425.08	447.78	1.7882	0.85613	1.0335	151.13	25.569	1.1226e-05	0.013044;...
325.00	0.71560	1038.9	0.00096253	267.86	268.54	1.2277	0.91413	1.4002	527.81	-0.046758	0.00017316	0.072007	0.0081872	31.517	0.031728	428.02	450.73	1.7882	0.86909	1.0587	150.25	24.684	1.1438e-05	0.013490;...
330.00	0.81110	1024.3	0.00097626	274.81	275.60	1.2489	0.92149	1.4200	506.46	-0.0039877	0.00016425	0.070348	0.0076081	35.771	0.027955	430.93	453.60	1.7883	0.88209	1.0858	149.19	23.894	1.1660e-05	0.013961;...
335.00	0.91572	1009.3	0.00099083	281.84	282.75	1.2701	0.92892	1.4416	485.05	0.044201	0.00015577	0.068714	0.0070366	40.502	0.024690	433.79	456.39	1.7885	0.89516	1.1151	147.95	23.195	1.1893e-05	0.014461;...
340.00	1.0300	993.68	0.0010064	288.96	290.00	1.2913	0.93645	1.4651	463.55	0.098881	0.00014768	0.067106	0.0064732	45.763	0.021852	436.58	459.09	1.7886	0.90832	1.1471	146.52	22.579	1.2140e-05	0.014994;...
345.00	1.1545	977.53	0.0010230	296.19	297.37	1.3124	0.94408	1.4911	441.95	0.16142	0.00013993	0.065524	0.0059183	51.619	0.019373	439.32	461.68	1.7887	0.92159	1.1825	144.89	22.043	1.2402e-05	0.015566;...
350.00	1.2897	960.75	0.0010409	303.51	304.85	1.3336	0.95185	1.5201	420.20	0.23361	0.00013249	0.063967	0.0053724	58.146	0.017198	441.96	464.15	1.7887	0.93502	1.2221	143.04	21.583	1.2684e-05	0.016184];

% Data for R142b
% Retrieved from https://webbook.nist.gov/chemistry/fluid on 2020-12-18
% Isobaric properties - 0.000001 MPa.
% Simply export the tap-separated data.

%Temperature (K)	Pressure (MPa)	Density (kg/m3)	Volume (m3/kg)	Internal Energy (kJ/kg)	Enthalpy (kJ/kg)	Entropy (J/g*K)	Cv (J/g*K)	Cp (J/g*K)	Sound Spd. (m/s)	Joule-Thomson (K/MPa)	Viscosity (Pa*s)	Therm. Cond. (W/m*K)	Phase
p1Pa = ...
[220	1e-06	5.4940e-05	18202.	365.24	383.45	2.6349	0.59779	0.68052	143.95	85.221	7.6607e-06	0.0065794;... vapor
225	1e-06	5.3719e-05	18615.	368.26	386.87	2.6503	0.60779	0.69053	145.43	77.090	7.8405e-06	0.0068433;... vapor
230	1e-06	5.2551e-05	19029.	371.32	390.35	2.6656	0.61773	0.70047	146.89	70.009	8.0204e-06	0.0071126;... vapor
235	1e-06	5.1433e-05	19443.	374.44	393.88	2.6807	0.62761	0.71035	148.34	63.817	8.2002e-06	0.0073871;... vapor
240	1e-06	5.0362e-05	19856.	377.60	397.45	2.6958	0.63743	0.72016	149.78	58.379	8.3800e-06	0.0076668;... vapor
245	1e-06	4.9334e-05	20270.	380.81	401.08	2.7107	0.64717	0.72991	151.20	53.582	8.5597e-06	0.0079516;... vapor
250	1e-06	4.8347e-05	20684.	384.07	404.75	2.7256	0.65685	0.73959	152.61	49.336	8.7393e-06	0.0082415;... vapor
255	1e-06	4.7399e-05	21097.	387.38	408.48	2.7403	0.66646	0.74920	154.00	45.562	8.9187e-06	0.0085364;... vapor
260	1e-06	4.6488e-05	21511.	390.73	412.25	2.7550	0.67600	0.75873	155.38	42.196	9.0978e-06	0.0088362;... vapor
265	1e-06	4.5610e-05	21925.	394.14	416.06	2.7695	0.68546	0.76820	156.75	39.184	9.2767e-06	0.0091408;... vapor
270	1e-06	4.4766e-05	22338.	397.59	419.93	2.7840	0.69485	0.77758	158.11	36.480	9.4553e-06	0.0094501;... vapor
275	1e-06	4.3952e-05	22752.	401.09	423.84	2.7983	0.70415	0.78689	159.45	34.044	9.6336e-06	0.0097642;... vapor
280	1e-06	4.3167e-05	23166.	404.63	427.80	2.8126	0.71338	0.79611	160.79	31.845	9.8115e-06	0.010083;... vapor
285	1e-06	4.2410e-05	23580.	408.22	431.80	2.8267	0.72252	0.80526	162.11	29.852	9.9890e-06	0.010406;... vapor
290	1e-06	4.1678e-05	23993.	411.85	435.85	2.8408	0.73158	0.81432	163.42	28.041	1.0166e-05	0.010734;... vapor
295	1e-06	4.0972e-05	24407.	415.54	439.94	2.8548	0.74056	0.82330	164.72	26.392	1.0343e-05	0.011065;... vapor
300	1e-06	4.0289e-05	24821.	419.26	444.08	2.8687	0.74945	0.83219	166.01	24.886	1.0519e-05	0.011402;... vapor
305	1e-06	3.9629e-05	25234.	423.03	448.26	2.8826	0.75826	0.84099	167.29	23.508	1.0694e-05	0.011742;... vapor
310	1e-06	3.8990e-05	25648.	426.84	452.49	2.8963	0.76698	0.84971	168.57	22.244	1.0869e-05	0.012086;... vapor
315	1e-06	3.8371e-05	26062.	430.70	456.76	2.9100	0.77561	0.85835	169.83	21.081	1.1044e-05	0.012435;... vapor
320	1e-06	3.7771e-05	26475.	434.60	461.07	2.9236	0.78415	0.86689	171.08	20.010	1.1218e-05	0.012787;... vapor
325	1e-06	3.7190e-05	26889.	438.54	465.43	2.9371	0.79261	0.87534	172.32	19.020	1.1391e-05	0.013144;... vapor
330	1e-06	3.6627e-05	27303.	442.52	469.83	2.9505	0.80098	0.88371	173.56	18.105	1.1564e-05	0.013504;... vapor
335	1e-06	3.6080e-05	27716.	446.55	474.27	2.9638	0.80926	0.89199	174.79	17.256	1.1736e-05	0.013867;... vapor
340	1e-06	3.5549e-05	28130.	450.62	478.75	2.9771	0.81745	0.90018	176.00	16.468	1.1907e-05	0.014235;... vapor
345	1e-06	3.5034e-05	28544.	454.72	483.27	2.9903	0.82555	0.90828	177.21	15.735	1.2078e-05	0.014606;... vapor
350	1e-06	3.4534e-05	28957.	458.87	487.83	3.0034	0.83356	0.91630	178.41	15.052	1.2248e-05	0.014980];... vapor
end

s = substance(name);
allT = satdata(:,1);
len = size(allT,1);
first = 1;
last = len;

% hsetup, find some values in R2015a/toolbox/matlab/graphics/exportsetupdlg.m
% or: Create a figure, click on "Export..", as long as the export dialog box
% remains, do: ff = get(gcf,'ExportsetupWindow'); ff.style
% Write the variable "hsetup" into (!) the base workspace
%  instead of "hsetup = struct('Version',... - in the base workspace
assignin('base', 'hsetup',...
	struct('Version',1,'Format','pdf','Preview','none','Width',450,...
        'Height',300,'Units','points','Color','bw','Background','w',...
        'FixedFontSize',8,'ScaledFontSize','auto','FontMode','fixed',...
        'FontSizeMin',8,'FixedLineWidth',.5,'ScaledLineWidth','100',...
        'LineMode','fixed','LineWidthMin',0.5,'FontName','Times',...
        'FontWeight','normal','FontAngle','auto','FontEncoding','latin1',...
        'PSLevel',3,'Renderer','auto','Resolution','auto',...
        'LineStyleMap','none','ApplyStyle',0,'Bounds','tight',...
        'LockAxes','on','LockAxesTicks','off','ShowUI','on',...
        'SeparateText','off'));

fprintf('Substance %s, critical temperature: %.1f K.\n',name,Tc);

fprintf(...
'\n*\n* To print, click on a figure and type the following two commands:\n*\n');
fprintf(...
['  set(gcf, ''PaperUnits'',''points'', ''PaperSize'',[450 300], ...\n'...
 '      ''PaperPosition'', [0 0 450 300]);\n'...
 '  hgexport(gcf, ''name.pdf'', hsetup);\n']);

setfirstlast('ps');
nonarrayplot(s.ps,'Saturation pressure',first,last,...
  allT,'T [K]',satdata(:,2)*1e6);

% Liquid density
setfirstlast('rho');
nonarrayplot(s.rho,'Density of the liquid',first,last,...
  allT,'T [K]',satdata(:,3));

% enthalpy of vaporization
setfirstlast('hvap');
nonarrayplot(s.hvap,'Enthalpy of vaporization',first,last,...
  allT,'T [K]',(satdata(:,18)-satdata(:,6))*1e3);

% Specific volume of the vapor
setfirstlast('v');
pplot(s.v,'Specific volume of the vapor',first,last,...
  allT,satdata(:,2)*1e6,'T [K]',satdata(:,16));

% Joule-Thomson coefficient
setfirstlast('jt');
pplot(s.jt,'Joule-Thomson coefficient',first,last,...
  allT,satdata(:,2)*1e6,'T [K]',satdata(:,23)*1e-6);

% Specific isobaric heat capacity of the vapor
setfirstlast('cpg');
pplot(s.cpg,'Specific isobaric heat capacity of the vapor',first,last,...
  allT,satdata(:,2)*1e6,'T [K]',satdata(:,21)*1e3);

% Specific isobaric heat capacity in the ideal gas state
setfirstlast('reset');
pplot(s.cpg,'Isobaric heat capacity, ideal gas state',1,size(p1Pa,1),...
  p1Pa(:,1),p1Pa(:,2)*1e6,'T [K]',p1Pa(:,9)*1e3);

% Specific isobaric heat capacity of the liquid
arrayplot(s.cpl,'Specific isobaric heat capacity of the liquid',first,last,...
  allT,'T [K]',satdata(:,9)*1e3);

% Surface tension
setfirstlast('sigma');
arrayplot(s.sigma,'Surface tension',first,last,allT,'T [K]',satdata(:,14));

% Dynamic viscosity of the liquid
setfirstlast('reset');
arrayplot(s.mul,'Dynamic viscosity of the liquid',first,last,...
  allT,'T [K]',satdata(:,12));

% Dynamic viscosity of the vapor
arrayplot(s.mug,'Dynamic viscosity of the vapor',first,last,...
  allT,'T [K]',satdata(:,24));

% Thermal conductivity of the vapor
setfirstlast('kg');
arrayplot(s.kg,'Thermal conductivity of the vapor',first,last,...
  allT,'T [K]',satdata(:,25));

% Thermal conductivity of the liquid
setfirstlast('reset');
arrayplot(s.kl,'Thermal conductivity of the liquid',first,last,...
  allT,'T [K]',satdata(:,13));

% Kinematic viscosity of the vapor
setfirstlast('nug');
pplot(s.nug,'Kinematic viscosity of the vapor',first,last,...
  allT,satdata(:,2)*1e6,'T [K]',satdata(:,24).*satdata(:,16));

% Kinematic viscosity of the liquid
setfirstlast('reset');
nonarrayplot(s.nul,'Kinematic viscosity of the liquid',first,last,...
  allT,'T [K]',satdata(:,12).*satdata(:,4));

function setfirstlast(var) %---- nested function --------
if isfield(N,var)
  if isfield(N.(var),'Tfirst')
    first = find(allT>N.(var).Tfirst,1);
  else
    first = 1;
  end
  if isfield(N.(var),'Tlast')
    last = find(allT>N.(var).Tlast,1) - 1 ;
  else
    last = len;
  end
else
  first = 1;
  last = len;
end
end %---------------------- end nested function ---------

end %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% end testsubstance %%%


function nonarrayplot(prop,description,first,last,X,xname,datanist) %-----------

global VERBOSE;
len = last - first + 1;
datam = zeros(len,1);
for i = 1:len
  datam(i,1) = prop(X(first-1+i,1));
end

figure('Name',description,'NumberTitle','Off');
plot(X(first:last),100*(datam./datanist(first:last)-1),'k*');
title(description);
ylabel('100*(matlab - nist)/nist');
xlabel(xname);

if VERBOSE
  printtable(description,X(first:last),datanist(first:last),datam);
end

end %---------------------------------------------------------------------------


function arrayplot(prop,description,first,last,X,xname,datanist) %--------------

global VERBOSE;
datam = prop(X(first:last));
figure('Name',description,'NumberTitle','Off');
plot(X(first:last),100*(datam./datanist(first:last)-1),'k*');
title(description);
ylabel('100*(matlab - nist)/nist');
xlabel(xname);

if VERBOSE
  printtable(description,X(first:last),datanist(first:last),datam);
end

end %---------------------------------------------------------------------------


function pplot(prop,description,first,last,X,P,xname,datanist) %----------------

global VERBOSE;
datam = prop(X(first:last),P(first:last));
figure('Name',description,'NumberTitle','Off');
plot(X(first:last),...
     100*(datam./datanist(first:last)-1),'k*');
title(description);
ylabel('100*(matlab - nist)/nist');
xlabel(xname);

if VERBOSE
 printtable(description,X(first:last),datanist(first:last),datam,P(first:last));
end

end %---------------------------------------------------------------------------


function pscalarplot(prop,description,first,last,X,P,xname,datanist) %----------

global VERBOSE;
len = last - first + 1;
datam = zeros(len,1);
for i = 0:len-1
  datam(i+1,1) = prop(X(first+i,1),P(first+i,1));
end

figure('Name',description,'NumberTitle','Off');
plot(X(first:last),100*(datam./datanist(first:last)-1),'k*');
title(description);
ylabel('100*(matlab - nist)/nist');
xlabel(xname);

if VERBOSE
 printtable(description,X(first:last),datanist(first:last),datam,P(first:last));
end

end %---------------------------------------------------------------------------


function printtable(description,X,datanist,datam,P) %---------------------------

fprintf(['\n' description ' \n']);
if nargin == 4
  fprintf('T [K]\tnist\tmatlab\t100*(matlab-nist)/nist\n');
  fprintf('%3.0f\t%.4g\t%.4g\t%.3f\n', ...
    [X'; datanist'; datam'; 100*(datam./datanist-1)']);
elseif nargin == 5
  if P(1) < 1e3
    fprintf('T [K]\tp [Pa]\tnist\tmatlab\t100*(matlab-nist)/nist\n');
    fprintf('%3.0f\t%.0f\t%.4g\t%.4g\t%.3f\n', ...
      [X'; P'; datanist'; datam'; 100*(datam./datanist-1)']);
  else
    fprintf('T [K]\tp [bar]\tnist\tmatlab\t100*(matlab-nist)/nist\n');
    fprintf('%3.0f\t%.4g\t%.4g\t%.4g\t%.3f\n', ...
      [X'; P'/1e5; datanist'; datam'; 100*(datam./datanist-1)']);
  end
end

end %---------------------------------------------------------------------------
